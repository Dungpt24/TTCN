{"ast":null,"code":"import axios from \"axios\";\nconst request = axios.create({\n  baseURL: \"http://192.168.83.97/\",\n  timeout: 60000,\n  headers: {\n    \"Content-Type\": \"application/json\"\n  }\n});\nexport const get = async function (pathApi) {\n  let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  const res = await request.get(pathApi, options);\n  return res.data;\n};\nexport const post = async (pathApi, payload, options) => {\n  const res = await request.post(pathApi, payload, options);\n  return res.data;\n};\nexport const put = async (pathApi, options) => {\n  const res = await request.put(pathApi, options);\n  return res.data;\n};\nrequest.response.use(async res => {\n  var _res$data, _res$data2;\n\n  // $message.success(response?.data?.msg);\n  console.log(res);\n\n  if ((res === null || res === void 0 ? void 0 : (_res$data = res.data) === null || _res$data === void 0 ? void 0 : _res$data.status) == 401 && !(res !== null && res !== void 0 && (_res$data2 = res.data) !== null && _res$data2 !== void 0 && _res$data2.auth)) {\n    //refresh token...\n    const refreshToken = local.get('refreshToken') || null;\n    const result = await axios.post('/getToken', {\n      refreshToken\n    });\n\n    if ((result === null || result === void 0 ? void 0 : result.status) === 200) {\n      local.add('accessToken', JSON.stringify(result.data.accessToken));\n    }\n  }\n\n  return res;\n}, err => {\n  var _err$response, _err$response2, _err$response2$data;\n\n  console.log('err', err);\n  $message.error(err === null || err === void 0 ? void 0 : (_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.data.msg);\n\n  if (!(err !== null && err !== void 0 && (_err$response2 = err.response) !== null && _err$response2 !== void 0 && (_err$response2$data = _err$response2.data) !== null && _err$response2$data !== void 0 && _err$response2$data.refreshToken)) {\n    local.clear();\n    window.confirm(\"Your session is expired...\");\n    window.location.replace('./login');\n  }\n\n  return err;\n});\nexport default request;","map":{"version":3,"names":["axios","request","create","baseURL","timeout","headers","get","pathApi","options","res","data","post","payload","put","response","use","console","log","status","auth","refreshToken","local","result","add","JSON","stringify","accessToken","err","$message","error","msg","clear","window","confirm","location","replace"],"sources":["/media/turborvip/_add_disk0114/project/learn/laravel-web-new/fe/web_news_php/src/ultis/request.js"],"sourcesContent":["import axios from \"axios\";\n\nconst request = axios.create({\n  baseURL: \"http://192.168.83.97/\",\n  timeout: 60000,\n  headers: {\n    \"Content-Type\": \"application/json\",\n  },\n});\n\nexport const get = async (pathApi, options = {}) => {\n  const res = await request.get(pathApi, options);\n  return res.data;\n};\n\nexport const post = async (pathApi, payload, options) => {\n  const res = await request.post(pathApi, payload, options);\n  return res.data;\n};\n\nexport const put = async (pathApi, options) => {\n  const res = await request.put(pathApi, options);\n  return res.data;\n};\n\nrequest.response.use(\n  async(res) => {\n    // $message.success(response?.data?.msg);\n    console.log(res);\n    if(res?.data?.status == 401 && !res?.data?.auth){\n      //refresh token...\n      const refreshToken = local.get('refreshToken') || null;\n      const result = await axios.post('/getToken',{refreshToken})\n      if(result?.status === 200){\n        local.add('accessToken',JSON.stringify(result.data.accessToken));\n      }\n    }\n    return res;\n  },\n  (err) => {\n    console.log('err',err)\n    $message.error(err?.response?.data.msg);\n    if(!err?.response?.data?.refreshToken){\n      local.clear();\n      window.confirm(\"Your session is expired...\");\n      window.location.replace('./login');\n    }\n    return err\n  }\n);\n\n\nexport default request;\n"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AAEA,MAAMC,OAAO,GAAGD,KAAK,CAACE,MAAN,CAAa;EAC3BC,OAAO,EAAE,uBADkB;EAE3BC,OAAO,EAAE,KAFkB;EAG3BC,OAAO,EAAE;IACP,gBAAgB;EADT;AAHkB,CAAb,CAAhB;AAQA,OAAO,MAAMC,GAAG,GAAG,gBAAOC,OAAP,EAAiC;EAAA,IAAjBC,OAAiB,uEAAP,EAAO;EAClD,MAAMC,GAAG,GAAG,MAAMR,OAAO,CAACK,GAAR,CAAYC,OAAZ,EAAqBC,OAArB,CAAlB;EACA,OAAOC,GAAG,CAACC,IAAX;AACD,CAHM;AAKP,OAAO,MAAMC,IAAI,GAAG,OAAOJ,OAAP,EAAgBK,OAAhB,EAAyBJ,OAAzB,KAAqC;EACvD,MAAMC,GAAG,GAAG,MAAMR,OAAO,CAACU,IAAR,CAAaJ,OAAb,EAAsBK,OAAtB,EAA+BJ,OAA/B,CAAlB;EACA,OAAOC,GAAG,CAACC,IAAX;AACD,CAHM;AAKP,OAAO,MAAMG,GAAG,GAAG,OAAON,OAAP,EAAgBC,OAAhB,KAA4B;EAC7C,MAAMC,GAAG,GAAG,MAAMR,OAAO,CAACY,GAAR,CAAYN,OAAZ,EAAqBC,OAArB,CAAlB;EACA,OAAOC,GAAG,CAACC,IAAX;AACD,CAHM;AAKPT,OAAO,CAACa,QAAR,CAAiBC,GAAjB,CACE,MAAMN,GAAN,IAAc;EAAA;;EACZ;EACAO,OAAO,CAACC,GAAR,CAAYR,GAAZ;;EACA,IAAG,CAAAA,GAAG,SAAH,IAAAA,GAAG,WAAH,yBAAAA,GAAG,CAAEC,IAAL,wDAAWQ,MAAX,KAAqB,GAArB,IAA4B,EAACT,GAAD,aAACA,GAAD,6BAACA,GAAG,CAAEC,IAAN,uCAAC,WAAWS,IAAZ,CAA/B,EAAgD;IAC9C;IACA,MAAMC,YAAY,GAAGC,KAAK,CAACf,GAAN,CAAU,cAAV,KAA6B,IAAlD;IACA,MAAMgB,MAAM,GAAG,MAAMtB,KAAK,CAACW,IAAN,CAAW,WAAX,EAAuB;MAACS;IAAD,CAAvB,CAArB;;IACA,IAAG,CAAAE,MAAM,SAAN,IAAAA,MAAM,WAAN,YAAAA,MAAM,CAAEJ,MAAR,MAAmB,GAAtB,EAA0B;MACxBG,KAAK,CAACE,GAAN,CAAU,aAAV,EAAwBC,IAAI,CAACC,SAAL,CAAeH,MAAM,CAACZ,IAAP,CAAYgB,WAA3B,CAAxB;IACD;EACF;;EACD,OAAOjB,GAAP;AACD,CAbH,EAcGkB,GAAD,IAAS;EAAA;;EACPX,OAAO,CAACC,GAAR,CAAY,KAAZ,EAAkBU,GAAlB;EACAC,QAAQ,CAACC,KAAT,CAAeF,GAAf,aAAeA,GAAf,wCAAeA,GAAG,CAAEb,QAApB,kDAAe,cAAeJ,IAAf,CAAoBoB,GAAnC;;EACA,IAAG,EAACH,GAAD,aAACA,GAAD,iCAACA,GAAG,CAAEb,QAAN,kEAAC,eAAeJ,IAAhB,gDAAC,oBAAqBU,YAAtB,CAAH,EAAsC;IACpCC,KAAK,CAACU,KAAN;IACAC,MAAM,CAACC,OAAP,CAAe,4BAAf;IACAD,MAAM,CAACE,QAAP,CAAgBC,OAAhB,CAAwB,SAAxB;EACD;;EACD,OAAOR,GAAP;AACD,CAvBH;AA2BA,eAAe1B,OAAf"},"metadata":{},"sourceType":"module"}